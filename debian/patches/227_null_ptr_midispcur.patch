Description: Check for NULL pointer before dereferencing pointer from miGetDCDevice.
 Fixes crash after connecting a bluetooth keyboard.
Author: Bryce Harrington <bryce@ubuntu.com>
Bug-Ubuntu: https://launchpad.net/bugs/930936

Index: xorg-server-1.17.2/mi/midispcur.c
===================================================================
--- xorg-server-1.17.2.orig/mi/midispcur.c
+++ xorg-server-1.17.2/mi/midispcur.c
@@ -435,6 +435,10 @@ miDCRestoreUnderCursor(DeviceIntPtr pDev
     GCPtr pGC;
 
     pBuffer = miGetDCDevice(pDev, pScreen);
+
+    if (!pBuffer)
+        return FALSE;
+
     pSave = pBuffer->pSave;
 
     pWin = pScreen->root;
