From 3fd969f08e4f550ac28fee3bbdbe55e9db872091 Mon Sep 17 00:00:00 2001
From: Adam Jackson <ajax@redhat.com>
Date: Mon, 3 Dec 2007 14:00:25 -0500
Subject: [PATCH] apm_event_t workaround

---
 hw/kdrive/linux/linux.c               |    2 ++
 hw/xfree86/os-support/linux/lnx_apm.c |    3 +++
 2 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/hw/kdrive/linux/linux.c b/hw/kdrive/linux/linux.c
index 23cd8f5..2f9cb62 100644
--- a/hw/kdrive/linux/linux.c
+++ b/hw/kdrive/linux/linux.c
@@ -275,6 +275,8 @@ LinuxApmBlock (pointer blockData, OSTimePtr pTimeout, pointer pReadmask)
 
 static Bool LinuxApmRunning;
 
+#define apm_event_t unsigned short
+
 static void
 LinuxApmWakeup (pointer blockData, int result, pointer pReadmask)
 {
diff --git a/hw/xfree86/os-support/linux/lnx_apm.c b/hw/xfree86/os-support/linux/lnx_apm.c
index 16ac80d..6bcae47 100644
--- a/hw/xfree86/os-support/linux/lnx_apm.c
+++ b/hw/xfree86/os-support/linux/lnx_apm.c
@@ -39,6 +39,9 @@ static PMClose lnxAPMOpen(void);
 static void lnxCloseAPM(void);
 static pointer APMihPtr = NULL;
 
+/* XXX this is wrong, do not ever commit me upstream */
+#define apm_event_t unsigned short
+
 static struct {
     apm_event_t apmLinux;
     pmEvent xf86;
-- 
1.5.2.4

