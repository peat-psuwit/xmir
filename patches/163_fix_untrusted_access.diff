From: Eamon Walsh <ewalsh@tycho.nsa.gov>
Date: Fri, 15 Feb 2008 00:47:44 +0000 (-0500)
Subject: security: Fix for Bug #14480: untrusted access broken in 7.3.
X-Git-Tag: xf-3_9_16Z / xf-3_9_16d / xf-3_9_16e / xf-3_9_16f
X-Git-Url: http://gitweb.freedesktop.org/?p=xorg/xserver.git;a=commitdiff;h=74b40bba327a2e97780e8e3f995f784add2d6231

security: Fix for Bug #14480: untrusted access broken in 7.3.
---

--- a/Xext/security.c
+++ b/Xext/security.c
@@ -1014,7 +1014,7 @@ CALLBACK(SecurityCheckResourceIDAccess)
     }
     else /* server-owned resource - probably a default colormap or root window */
     {
-	if (RT_WINDOW == rtype || RC_DRAWABLE == rtype)
+	if (RC_DRAWABLE & rtype)
 	{
 	    switch (reqtype)
 	    {   /* the following operations are allowed on root windows */
