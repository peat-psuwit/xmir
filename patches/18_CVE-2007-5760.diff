--- xorg-server.orig/hw/xfree86/common/xf86MiscExt.c
+++ xorg-server/hw/xfree86/common/xf86MiscExt.c
@@ -548,6 +548,10 @@
 {
     ScrnInfoPtr pScr = xf86Screens[scrnIndex];
 
+    /* should check this in the protocol, but xf86NumScreens isn't exported */
+    if (scrnIndex > xf86NumScreens)
+	return BadValue;
+
     if (*pScr->HandleMessage == NULL)
 	    return BadImplementation;
     return (*pScr->HandleMessage)(scrnIndex, msgtype, msgval, retstr);
