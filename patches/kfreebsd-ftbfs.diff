From 4cc33190ef1a4207c0f8fc74201cdf2568a239c2 Mon Sep 17 00:00:00 2001
From: Julien Cristau <jcristau@debian.org>
Date: Thu, 14 May 2009 17:01:57 +0200
Subject: [PATCH] xfree86: Add two __FreeBSD_kernel__ checks

Debian bug#525475 <http://bugs.debian.org/525475>

Reported-by: Petr Salinger <Petr.Salinger@seznam.cz>
Signed-off-by: Julien Cristau <jcristau@debian.org>
---
 hw/xfree86/os-support/bus/Pci.h            |    3 ++-
 hw/xfree86/os-support/shared/stdResource.c |    3 ++-
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/hw/xfree86/os-support/bus/Pci.h b/hw/xfree86/os-support/bus/Pci.h
index 7623e97..79b38f0 100644
--- a/hw/xfree86/os-support/bus/Pci.h
+++ b/hw/xfree86/os-support/bus/Pci.h
@@ -168,7 +168,8 @@
 
 #endif /* !defined(DEBUGPCI) */
 
-#if defined(__FreeBSD__) || defined(__OpenBSD__) || defined(__NetBSD__) || \
+#if defined(__FreeBSD__) || defined(__FreeBSD_kernel__) || \
+	defined(__OpenBSD__) || defined(__NetBSD__) || \
 	defined(__DragonFly__) || defined(__sun) || defined(__GNU__)
 #define ARCH_PCI_INIT bsdPciInit
 #endif
diff --git a/hw/xfree86/os-support/shared/stdResource.c b/hw/xfree86/os-support/shared/stdResource.c
index a4c162d..9db349b 100644
--- a/hw/xfree86/os-support/shared/stdResource.c
+++ b/hw/xfree86/os-support/shared/stdResource.c
@@ -43,7 +43,8 @@
 /* Avoid Imakefile changes */
 #include "bus/Pci.h"
 
-#if defined(__FreeBSD__) || defined(__NetBSD__) || defined(__OpenBSD__) || \
+#if defined(__FreeBSD__) || defined(__FreeBSD_kernel__) || \
+	defined(__NetBSD__) || defined(__OpenBSD__) || \
 	defined(__DragonFly__) || defined(__sun) || defined(__GNU__)
 #define xf86StdAccResFromOS xf86AccResFromOS
 #endif
-- 
1.6.2.4

